<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Istio sidecar iptables and traffic steering detail - apcj@f5 technical blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="icon" href="/favicon.png">

  
  
  <link rel="stylesheet" href="/css/style.min.6719d72e323121369d5caeb4264b95d8a63cf1deaab029da67602fe5a046e0a4.css">
  

  

</head>

<body class='page page-default-single'>
  <div id="main-menu-mobile" class="main-menu-mobile">
  <ul>
    
    
    <li class="menu-item-home">
      <a href="/">
        <span>Home</span>
      </a>
    </li>
    
    <li class="menu-item-posts">
      <a href="/posts/">
        <span>Posts</span>
      </a>
    </li>
    
  </ul>
</div>
  <div class="wrapper">
    <div class='header'>
  <div class="container">
    <div class="logo">
      <a href="/"><img alt="Logo" src="/images/logo.svg" /></a>
    </div>
    <div class="logo-mobile">
      <a href="/"><img alt="Logo" src="/images/logo-mobile.svg" /></a>
    </div>
    <div id="main-menu" class="main-menu">
  <ul>
    
    
    <li class="menu-item-home">
      <a href="/">
        <span>Home</span>
      </a>
    </li>
    
    <li class="menu-item-posts">
      <a href="/posts/">
        <span>Posts</span>
      </a>
    </li>
    
  </ul>
</div>
    <button id="toggle-main-menu-mobile" class="hamburger hamburger--slider" type="button">
  <span class="hamburger-box">
    <span class="hamburger-inner"></span>
  </span>
</button>
  </div>
</div>


    
    
    
    
    
    

    
    <div class="container pt-2 pt-md-6 pb-3 pb-md-6">
      <div class="row">
        <div class="col-12 col-md-3 mb-3">
          <div class="sidebar">
            
<div class="docs-menu">
  <h4>Posts</h4>
  <ul>
    
    <li class="">
      <a href="/posts/ephemeral-kubernetes-lab-with-iac-and-gitops/">Ephemeral Kubernetes Lab with IaC and GitOps</a>
    </li>
    
    <li class="">
      <a href="/posts/kubernetes/sql-server-kubernetes-2/">SQL Server on Kubernetes - Part 2</a>
    </li>
    
    <li class="">
      <a href="/posts/learning-istio/jwt-auth/">Learning Istio | JWT Auth</a>
    </li>
    
    <li class="">
      <a href="/posts/kubernetes/sql-server-kubernetes/">SQL Server on Kubernetes - Part 1</a>
    </li>
    
    <li class="">
      <a href="/posts/learning-istio/securing-egress-traffic-with-mtls/">Learning Istio | Securing Egress Traffic With mTLS</a>
    </li>
    
    <li class="">
      <a href="/posts/automation/terraform-maps/">Terraform Maps</a>
    </li>
    
    <li class="">
      <a href="/posts/learning-istio/why-isnt-service-entry-namespaced/">Learning Istio | Why Isn&#39;t Service Entry Namespaced!?</a>
    </li>
    
    <li class="">
      <a href="/posts/learning-istio/accessing-external-tcp-services-using-serviceentry/">Learning Istio | Accessing external TCP services using ServiceEntry</a>
    </li>
    
    <li class="">
      <a href="/posts/development/nginx-unit/">NGINX Unit</a>
    </li>
    
    <li class="">
      <a href="/posts/learning-istio/ingress/">Learning Istio | Ingress</a>
    </li>
    
    <li class="">
      <a href="/posts/learning-istio/setup/">Learning Istio | Setup</a>
    </li>
    
    <li class="">
      <a href="/posts/from-lb-to-cloud-native-application-services/">From load balancing to cloud native application services</a>
    </li>
    
    <li class="">
      <a href="/posts/eli5-kubernetes-custom-resources/">ELI5: Kubernetes Custom Resources</a>
    </li>
    
    <li class="">
      <a href="/posts/kubernetes/smallest-container-ever/">Small Containers for fun </a>
    </li>
    
    <li class="">
      <a href="/posts/learning-terraform-s3-backend/">Learning Terraform S3 Backend</a>
    </li>
    
    <li class="">
      <a href="/posts/istio-ingressgateay-port-relationship/">The rule of Istio Gateway port definition</a>
    </li>
    
    <li class="">
      <a href="/posts/f5-envoy-cloud-native/">How an application delivery veteran see Envoy in the era of cloud native</a>
    </li>
    
    <li class="active ">
      <a href="/posts/istio-traffic-control-deepdive/">Istio sidecar iptables and traffic steering detail</a>
    </li>
    
    <li class="">
      <a href="/posts/f5-istio-work-together/">F5 BIG-IP links Istio to enhance ingress service capabilities</a>
    </li>
    
    <li class="">
      <a href="/posts/nginx-oauth2-oidc-series/">NGINX and oAuth2/OIDC series one</a>
    </li>
    
  </ul>
</div>

          </div>
        </div>
        <div class="col-12 col-md-9">
          
<h1 class="title">Istio sidecar iptables and traffic steering detail</h1>
<div class="content ">
  <h2 id="istio-injected-iptables">Istio injected iptables</h2>
<p>Istio implements the hijacking and processing of traffic by injecting the init container and envoy proxy container into the business pod. After the init container runs, the following NAT table rules for iptables will be generated in the corresponding linux namespace</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">&amp;#91;root@k8s-node1-v1-16 ~]# iptables -t nat -L -v
Chain PREROUTING (policy ACCEPT 192K packets, 12M bytes)
 pkts bytes target     prot opt in     out     source               destination
 192K   12M ISTIO_INBOUND  tcp  --  any    any     anywhere             anywhere

Chain INPUT (policy ACCEPT 192K packets, 12M bytes)
 pkts bytes target     prot opt in     out     source               destination

Chain OUTPUT (policy ACCEPT 40673 packets, 3694K bytes)
 pkts bytes target     prot opt in     out     source               destination
 8917  535K ISTIO_OUTPUT  tcp  --  any    any     anywhere             anywhere

Chain POSTROUTING (policy ACCEPT 40673 packets, 3694K bytes)
 pkts bytes target     prot opt in     out     source               destination

Chain ISTIO_INBOUND (1 references)
 pkts bytes target     prot opt in     out     source               destination
    0     0 RETURN     tcp  --  any    any     anywhere             anywhere             tcp dpt:ssh
  356 21360 RETURN     tcp  --  any    any     anywhere             anywhere             tcp dpt:15090
 192K   11M RETURN     tcp  --  any    any     anywhere             anywhere             tcp dpt:15021
    0     0 RETURN     tcp  --  any    any     anywhere             anywhere             tcp dpt:15020
   34  2040 ISTIO_IN_REDIRECT  tcp  --  any    any     anywhere             anywhere

Chain ISTIO_IN_REDIRECT (3 references)
 pkts bytes target     prot opt in     out     source               destination
   34  2040 REDIRECT   tcp  --  any    any     anywhere             anywhere             redir ports 15006

Chain ISTIO_OUTPUT (1 references)
 pkts bytes target     prot opt in     out     source               destination
    0     0 RETURN     all  --  any    lo      127.0.0.6            anywhere    
    0     0 ISTIO_IN_REDIRECT  all  --  any    lo      anywhere            !localhost            owner UID match 1337
    0     0 RETURN     all  --  any    lo      anywhere             anywhere             ! owner UID match 1337
 8917  535K RETURN     all  --  any    any     anywhere             anywhere             owner UID match 1337
    0     0 ISTIO_IN_REDIRECT  all  --  any    lo      anywhere            !localhost            owner GID match 1337
    0     0 RETURN     all  --  any    lo      anywhere             anywhere             ! owner GID match 1337
    0     0 RETURN     all  --  any    any     anywhere             anywhere             owner GID match 1337
    0     0 RETURN     all  --  any    any     anywhere             localhost
    0     0 ISTIO_REDIRECT  all  --  any    any     anywhere             anywhere

Chain ISTIO_REDIRECT (1 references)
 pkts bytes target     prot opt in     out     source               destination
    0     0 REDIRECT   tcp  --  any    any     anywhere             anywhere             redir ports 15001
</code></pre></div><h2 id="outbound-flow-control">Outbound flow control</h2>
<p>When the business container sends the request to the outside, such as productpage to reviews: 9080 port access, this connection will be redirected by iptables to port 127.0.0.1:115001, and then processed by envoy.</p>
<blockquote>
<p>REDIRECT
This target is only valid in the nat table, in the PREROUTING and OUTPUT chains, and user-defined chains which are only called from those chains. It redirects the packet to the machine itself by changing the destination IP to the primary address of the incoming interface (locally-generated packets are mapped to the localhost address, 127.0.0.1 for IPv4 and ::1 for IPv6).</p>
<p><a href="https://ipset.netfilter.org/iptables-extensions.man.html#lbDK">https://ipset.netfilter.org/iptables-extensions.man.html#lbDK</a></p>
</blockquote>
<p>The virtualOutbound in envoy will be hit. This is a special listener. It contains the Original Destination listener filter. Note &ldquo;useOriginalDst&rdquo;: truethat after such configuration in the following configuration , envoy will re-find the matching listener in the configuration. If found, press the hit. The listener performs follow-up processing. If it cannot find it, it sends the request to the cluster in this listener. Here is a passthrough cluster. This cluster will forward the packet directly to the fourth layer.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">root@k8s-master-v1-16 ~]# istioctl proxy-config listener productpage-v1-7f4cc988c6-qxqjs.istio-bookinfo --port 15001 -o json
&amp;#91;
    {
        &#34;name&#34;: &#34;virtualOutbound&#34;,
        &#34;address&#34;: {
            &#34;socketAddress&#34;: {
                &#34;address&#34;: &#34;0.0.0.0&#34;,
                &#34;portValue&#34;: 15001
            }
        },
        &#34;filterChains&#34;: &amp;#91;
            {
                &#34;filters&#34;: &amp;#91;
                    {
                        &#34;name&#34;: &#34;istio.stats&#34;,
                        &#34;typedConfig&#34;: {
                            &#34;@type&#34;: &#34;type.googleapis.com/udpa.type.v1.TypedStruct&#34;,
                            &#34;typeUrl&#34;: &#34;type.googleapis.com/envoy.extensions.filters.network.wasm.v3.Wasm&#34;,
                            &#34;value&#34;: {
                                &#34;config&#34;: {
                                    &#34;configuration&#34;: &#34;{\n  \&#34;debug\&#34;: \&#34;false\&#34;,\n  \&#34;stat_prefix\&#34;: \&#34;istio\&#34;\n}\n&#34;,
                                    &#34;root_id&#34;: &#34;stats_outbound&#34;,
                                    &#34;vm_config&#34;: {
                                        &#34;code&#34;: {
                                            &#34;local&#34;: {
                                                &#34;inline_string&#34;: &#34;envoy.wasm.stats&#34;
                                            }
                                        },
                                        &#34;runtime&#34;: &#34;envoy.wasm.runtime.null&#34;,
                                        &#34;vm_id&#34;: &#34;tcp_stats_outbound&#34;
                                    }
                                }
                            }
                        }
                    },
                    {
                        &#34;name&#34;: &#34;envoy.tcp_proxy&#34;,
                        &#34;typedConfig&#34;: {
                            &#34;@type&#34;: &#34;type.googleapis.com/envoy.config.filter.network.tcp_proxy.v2.TcpProxy&#34;,
                            &#34;statPrefix&#34;: &#34;PassthroughCluster&#34;,
                            &#34;cluster&#34;: &#34;PassthroughCluster&#34;,
                            &#34;accessLog&#34;: &amp;#91;
                                {
                                    &#34;name&#34;: &#34;envoy.file_access_log&#34;,
                                    &#34;typedConfig&#34;: {
                                        &#34;@type&#34;: &#34;type.googleapis.com/envoy.config.accesslog.v2.FileAccessLog&#34;,
                                        &#34;path&#34;: &#34;/dev/stdout&#34;,
                                        &#34;format&#34;: &#34;&amp;#91;%START_TIME%] \&#34;%REQ(:METHOD)% %REQ(X-ENVOY-ORIGINAL-PATH?:PATH)% %PROTOCOL%\&#34; %RESPONSE_CODE% %RESPONSE_FLAGS% \&#34;%DYNAMIC_METADATA(istio.mixer:status)%\&#34; \&#34;%UPSTREAM_TRANSPORT_FAILURE_REASON%\&#34; %BYTES_RECEIVED% %BYTES_SENT% %DURATION% %RESP(X-ENVOY-UPSTREAM-SERVICE-TIME)% \&#34;%REQ(X-FORWARDED-FOR)%\&#34; \&#34;%REQ(USER-AGENT)%\&#34; \&#34;%REQ(X-REQUEST-ID)%\&#34; \&#34;%REQ(:AUTHORITY)%\&#34; \&#34;%UPSTREAM_HOST%\&#34; %UPSTREAM_CLUSTER% %UPSTREAM_LOCAL_ADDRESS% %DOWNSTREAM_LOCAL_ADDRESS% %DOWNSTREAM_REMOTE_ADDRESS% %REQUESTED_SERVER_NAME% %ROUTE_NAME%\n&#34;
                                    }
                                }
                            ]
                        }
                    }
                ],
                &#34;name&#34;: &#34;virtualOutbound-catchall-tcp&#34;
            }
        ],
        &#34;useOriginalDst&#34;: true,
        &#34;trafficDirection&#34;: &#34;OUTBOUND&#34;
    }
]
</code></pre></div><p>The above listener will hand over the connection to the listener that matches the original destination IP and port. In the bookinfo example, it will be handed over to the 9080 listener. There is a question to consider here. From the perspective of envoy, the destination port of this link is already 15001, why can it match the following port 0.0.0.0:9080. This is because the NAT is done in the system kernel when iptables is redirected. The system kernel has this converted storage. Envoy obtains the real destination port through getsockopt() , so that it can correctly match the business listener.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">&amp;#91;root@k8s-master-v1-16 ~]# istioctl proxy-config listener productpage-v1-7f4cc988c6-qxqjs.istio-bookinfo --port 9080 -o json
&amp;#91;
    {
        &#34;name&#34;: &#34;0.0.0.0_9080&#34;,
        &#34;address&#34;: {
            &#34;socketAddress&#34;: {
                &#34;address&#34;: &#34;0.0.0.0&#34;,
                &#34;portValue&#34;: 9080
            }
        },
        &#34;filterChains&#34;: &amp;#91;
            {
                &#34;filterChainMatch&#34;: {
                    &#34;applicationProtocols&#34;: &amp;#91;
                        &#34;http/1.0&#34;,
                        &#34;http/1.1&#34;,
                        &#34;h2c&#34;
                    ]
                },
                &#34;filters&#34;: &amp;#91;
                    {
                        &#34;name&#34;: &#34;envoy.http_connection_manager&#34;,
                        &#34;typedConfig&#34;: {
                            &#34;@type&#34;: &#34;type.googleapis.com/envoy.config.filter.network.http_connection_manager.v2.HttpConnectionManager&#34;,
                            &#34;statPrefix&#34;: &#34;outbound_0.0.0.0_9080&#34;,
                            &#34;rds&#34;: {
                                &#34;configSource&#34;: {
                                    &#34;ads&#34;: {}
                                },
                                &#34;routeConfigName&#34;: &#34;9080&#34;
                            },
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">&amp;#91;root@k8s-master-v1-16 ~]# istioctl proxy-config listener productpage-v1-7f4cc988c6-qxqjs.istio-bookinfo
ADDRESS            PORT      TYPE
10.102.252.88      15012     TCP
10.96.122.225      31400     TCP
10.96.0.10         53        TCP
10.110.88.185      15443     TCP
10.96.122.225      15443     TCP
10.110.88.185      443       TCP
10.102.252.88      443       TCP
10.106.109.172     9001      TCP
10.96.0.1          443       TCP
10.96.122.225      443       TCP
10.106.109.172     9000      TCP
10.105.130.171     14267     HTTP+TCP
10.96.81.27        5601      HTTP+TCP
0.0.0.0            15014     HTTP+TCP
10.105.130.171     14250     HTTP+TCP
0.0.0.0            20001     HTTP+TCP
0.0.0.0            9411      HTTP+TCP
10.111.37.34       9090      HTTP+TCP
10.105.145.36      80        HTTP+TCP
10.105.130.171     14268     HTTP+TCP
10.96.0.10         9153      HTTP+TCP
10.110.244.188     80        HTTP+TCP
10.102.252.88      853       HTTP+TCP
10.99.139.251      16686     HTTP+TCP
0.0.0.0            12345     HTTP+TCP
10.103.155.149     80        HTTP+TCP
0.0.0.0            8000      HTTP+TCP
0.0.0.0            15010     HTTP+TCP
10.96.122.225      15020     HTTP+TCP
0.0.0.0            9090      HTTP+TCP
10.107.150.251     80        HTTP+TCP
0.0.0.0            14250     HTTP+TCP
0.0.0.0            80        HTTP+TCP
0.0.0.0            3000      HTTP+TCP
10.110.28.96       8181      HTTP+TCP
10.102.69.143      9200      HTTP+TCP
0.0.0.0            9080      HTTP+TCP 《《《《《《《《《《《《
0.0.0.0            15001     TCP 《《《《《《《《《《《《
0.0.0.0            15006     HTTP+TCP
0.0.0.0            15090     HTTP
0.0.0.0            15021     HTTP
</code></pre></div><p>Related passthrough cluster:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">root@k8s-master-v1-16 ~]# istioctl proxy-config cluster productpage-v1-7f4cc988c6-qxqjs.istio-bookinfo --fqdn PassthroughCluster -o json
&amp;#91;
。。。。忽略。。。
    {
        &#34;name&#34;: &#34;PassthroughCluster&#34;,
        &#34;type&#34;: &#34;ORIGINAL_DST&#34;,
        &#34;connectTimeout&#34;: &#34;10s&#34;,
        &#34;lbPolicy&#34;: &#34;CLUSTER_PROVIDED&#34;,
        &#34;circuitBreakers&#34;: {
            &#34;thresholds&#34;: &amp;#91;
                {
                    &#34;maxConnections&#34;: 4294967295,
                    &#34;maxPendingRequests&#34;: 4294967295,
                    &#34;maxRequests&#34;: 4294967295,
                    &#34;maxRetries&#34;: 4294967295
                }
            ]
        },
        &#34;filters&#34;: &amp;#91;
            {
                &#34;name&#34;: &#34;istio.metadata_exchange&#34;,
                &#34;typedConfig&#34;: {
                    &#34;@type&#34;: &#34;type.googleapis.com/udpa.type.v1.TypedStruct&#34;,
                    &#34;typeUrl&#34;: &#34;type.googleapis.com/envoy.tcp.metadataexchange.config.MetadataExchange&#34;,
                    &#34;value&#34;: {
                        &#34;protocol&#34;: &#34;istio-peer-exchange&#34;
                    }
                }
            }
        ]
    }
]
</code></pre></div><h2 id="inbound-flow-control">Inbound flow control</h2>
<p>When it is an inbound request, the destination address of the packet is the IP of the pod, and the destination port is the real port of the business (9080, non-svc mapping port). Since the link destination port of iptables is changed to 15006, it will Hit virtual inbound listener (0.0.0.0:15006), this listener has a series of filterchain, and the virtualoutbound listener configuration method is different, virtualinbound contains a series of actual service filters for specific ports, the connection will find specific in these fitlers Business matching. So how does it match the real 9080 business? For example, the following output:
addressPrefix can be matched. If the pod actually has multiple ports, only addressPrefix does not match. It also needs to match the application layer protocol, but the DestinationPort in the Match condition is not matched . In fact, it is similar to Virtualoutbound. The filter of the original destination listener is also used, so envoy will obtain the real destination port and IP from the kernel. This configuration method is different from the virtual outbound &ldquo;useOriginalDst&rdquo;: true configuration method, because this is an updated configuration method.&quot; useOriginalDst&quot;: true This configuration is about to be abandoned.</p>
<p><code>&quot;listenerFilters&quot;: [ { &quot;name&quot;: &quot;envoy.listener.original_dst&quot;, &quot;typedConfig&quot;: { &quot;@type&quot;: &quot;type.googleapis.com/envoy.config.filter.listener.original_dst.v2.OriginalDst&quot; } },</code></p>
<p>(According to <a href="https://www.envoyproxy.io/docs/envoy/latest/api-v2/api/v2/listener/listener_components.proto">https://www.envoyproxy.io/docs/envoy/latest/api-v2/api/v2/listener/listener_components.proto</a>, the  filtermatch condition is that all must match)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">            {
                &#34;filterChainMatch&#34;: {
                    &#34;destinationPort&#34;: 9080,
                    &#34;prefixRanges&#34;: &amp;#91;
                        {
                            &#34;addressPrefix&#34;: &#34;10.244.2.138&#34;,
                            &#34;prefixLen&#34;: 32
                        }
                    ],
### 根据https://istio.io/latest/zh/docs/ops/deployment/requirements/ , 
### 同一个业务端口是不能被两个用不同协议的svc来发布的，因此这帮助避免了同端口同协议的match在整个配置文件里的出现。
                    &#34;applicationProtocols&#34;: &amp;#91;
                        &#34;istio&#34;,
                        &#34;istio-http/1.0&#34;,
                        &#34;istio-http/1.1&#34;,
                        &#34;istio-h2&#34;
                    ]
                },
                &#34;filters&#34;: &amp;#91;
                    {
                        &#34;name&#34;: &#34;istio.metadata_exchange&#34;,
                        &#34;typedConfig&#34;: {
                            &#34;@type&#34;: &#34;type.googleapis.com/udpa.type.v1.TypedStruct&#34;,
                            &#34;typeUrl&#34;: &#34;type.googleapis.com/envoy.tcp.metadataexchange.config.MetadataExchange&#34;,
                            &#34;value&#34;: {
                                &#34;protocol&#34;: &#34;istio-peer-exchange&#34;
                            }
                        }
                    },
                    {
                        &#34;name&#34;: &#34;envoy.http_connection_manager&#34;,
                        &#34;typedConfig&#34;: {
                            &#34;@type&#34;: &#34;type.googleapis.com/envoy.config.filter.network.http_connection_manager.v2.HttpConnectionManager&#34;,
                            &#34;statPrefix&#34;: &#34;inbound_10.244.2.138_9080&#34;,
                            &#34;routeConfig&#34;: {
                                &#34;name&#34;: &#34;inbound|9080|http|productpage.istio-bookinfo.svc.cluster.local&#34;,
                                &#34;virtualHosts&#34;: &amp;#91;
                                    {
                                        &#34;name&#34;: &#34;inbound|http|9080&#34;,
                                        &#34;domains&#34;: &amp;#91;
                                            &#34;*&#34;
                                        ],
                                        &#34;routes&#34;: &amp;#91;
                                            {
                                                &#34;name&#34;: &#34;default&#34;,
                                                &#34;match&#34;: {
                                                    &#34;prefix&#34;: &#34;/&#34;
                                                },
                                                &#34;route&#34;: {
                                                    &#34;cluster&#34;: &#34;inbound|9080|http|productpage.istio-bookinfo.svc.cluster.local&#34;,
                                                    &#34;timeout&#34;: &#34;0s&#34;,
                                                    &#34;maxGrpcTimeout&#34;: &#34;0s&#34;
                                                },
                                                &#34;decorator&#34;: {
                                                    &#34;operation&#34;: &#34;productpage.istio-bookinfo.svc.cluster.local:9080/*&#34;
                                                }
                                            }
                                        ]
                                    }
                                ],
</code></pre></div><h2 id="last">Last</h2>
<p>Attach the actual configuration of 15006</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">&amp;#91;root@k8s-master-v1-16 ~]# istioctl proxy-config listener productpage-v1-7f4cc988c6-qxqjs.istio-bookinfo --port 15006 -o json
&amp;#91;
    {
        &#34;name&#34;: &#34;virtualInbound&#34;,
        &#34;address&#34;: {
            &#34;socketAddress&#34;: {
                &#34;address&#34;: &#34;0.0.0.0&#34;,
                &#34;portValue&#34;: 15006
            }
        },
        &#34;filterChains&#34;: &amp;#91;
            {
                &#34;filterChainMatch&#34;: {
                    &#34;prefixRanges&#34;: &amp;#91;
                        {
                            &#34;addressPrefix&#34;: &#34;0.0.0.0&#34;,
                            &#34;prefixLen&#34;: 0
                        }
                    ],
                    &#34;transportProtocol&#34;: &#34;tls&#34;,
                    &#34;applicationProtocols&#34;: &amp;#91;
                        &#34;istio-peer-exchange&#34;,
                        &#34;istio&#34;
                    ]
                },
                &#34;filters&#34;: &amp;#91;
                    {
                        &#34;name&#34;: &#34;istio.metadata_exchange&#34;,
                        &#34;typedConfig&#34;: {
                            &#34;@type&#34;: &#34;type.googleapis.com/udpa.type.v1.TypedStruct&#34;,
                            &#34;typeUrl&#34;: &#34;type.googleapis.com/envoy.tcp.metadataexchange.config.MetadataExchange&#34;,
                            &#34;value&#34;: {
                                &#34;protocol&#34;: &#34;istio-peer-exchange&#34;
                            }
                        }
                    },
                    {
                        &#34;name&#34;: &#34;istio.stats&#34;,
                        &#34;typedConfig&#34;: {
                            &#34;@type&#34;: &#34;type.googleapis.com/udpa.type.v1.TypedStruct&#34;,
                            &#34;typeUrl&#34;: &#34;type.googleapis.com/envoy.extensions.filters.network.wasm.v3.Wasm&#34;,
                            &#34;value&#34;: {
                                &#34;config&#34;: {
                                    &#34;configuration&#34;: &#34;{\n  \&#34;debug\&#34;: \&#34;false\&#34;,\n  \&#34;stat_prefix\&#34;: \&#34;istio\&#34;\n}\n&#34;,
                                    &#34;root_id&#34;: &#34;stats_inbound&#34;,
                                    &#34;vm_config&#34;: {
                                        &#34;code&#34;: {
                                            &#34;local&#34;: {
                                                &#34;inline_string&#34;: &#34;envoy.wasm.stats&#34;
                                            }
                                        },
                                        &#34;runtime&#34;: &#34;envoy.wasm.runtime.null&#34;,
                                        &#34;vm_id&#34;: &#34;tcp_stats_inbound&#34;
                                    }
                                }
                            }
                        }
                    },
                    {
                        &#34;name&#34;: &#34;envoy.tcp_proxy&#34;,
                        &#34;typedConfig&#34;: {
                            &#34;@type&#34;: &#34;type.googleapis.com/envoy.config.filter.network.tcp_proxy.v2.TcpProxy&#34;,
                            &#34;statPrefix&#34;: &#34;InboundPassthroughClusterIpv4&#34;,
                            &#34;cluster&#34;: &#34;InboundPassthroughClusterIpv4&#34;,
                            &#34;accessLog&#34;: &amp;#91;
                                {
                                    &#34;name&#34;: &#34;envoy.file_access_log&#34;,
                                    &#34;typedConfig&#34;: {
                                        &#34;@type&#34;: &#34;type.googleapis.com/envoy.config.accesslog.v2.FileAccessLog&#34;,
                                        &#34;path&#34;: &#34;/dev/stdout&#34;,
                                        &#34;format&#34;: &#34;&amp;#91;%START_TIME%] \&#34;%REQ(:METHOD)% %REQ(X-ENVOY-ORIGINAL-PATH?:PATH)% %PROTOCOL%\&#34; %RESPONSE_CODE% %RESPONSE_FLAGS% \&#34;%DYNAMIC_METADATA(istio.mixer:status)%\&#34; \&#34;%UPSTREAM_TRANSPORT_FAILURE_REASON%\&#34; %BYTES_RECEIVED% %BYTES_SENT% %DURATION% %RESP(X-ENVOY-UPSTREAM-SERVICE-TIME)% \&#34;%REQ(X-FORWARDED-FOR)%\&#34; \&#34;%REQ(USER-AGENT)%\&#34; \&#34;%REQ(X-REQUEST-ID)%\&#34; \&#34;%REQ(:AUTHORITY)%\&#34; \&#34;%UPSTREAM_HOST%\&#34; %UPSTREAM_CLUSTER% %UPSTREAM_LOCAL_ADDRESS% %DOWNSTREAM_LOCAL_ADDRESS% %DOWNSTREAM_REMOTE_ADDRESS% %REQUESTED_SERVER_NAME% %ROUTE_NAME%\n&#34;
                                    }
                                }
                            ]
                        }
                    }
                ],
                &#34;transportSocket&#34;: {
                    &#34;name&#34;: &#34;envoy.transport_sockets.tls&#34;,
                    &#34;typedConfig&#34;: {
                        &#34;@type&#34;: &#34;type.googleapis.com/envoy.api.v2.auth.DownstreamTlsContext&#34;,
                        &#34;commonTlsContext&#34;: {
                            &#34;tlsCertificateSdsSecretConfigs&#34;: &amp;#91;
                                {
                                    &#34;name&#34;: &#34;default&#34;,
                                    &#34;sdsConfig&#34;: {
                                        &#34;apiConfigSource&#34;: {
                                            &#34;apiType&#34;: &#34;GRPC&#34;,
                                            &#34;grpcServices&#34;: &amp;#91;
                                                {
                                                    &#34;envoyGrpc&#34;: {
                                                        &#34;clusterName&#34;: &#34;sds-grpc&#34;
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                }
                            ],
                            &#34;combinedValidationContext&#34;: {
                                &#34;defaultValidationContext&#34;: {},
                                &#34;validationContextSdsSecretConfig&#34;: {
                                    &#34;name&#34;: &#34;ROOTCA&#34;,
                                    &#34;sdsConfig&#34;: {
                                        &#34;apiConfigSource&#34;: {
                                            &#34;apiType&#34;: &#34;GRPC&#34;,
                                            &#34;grpcServices&#34;: &amp;#91;
                                                {
                                                    &#34;envoyGrpc&#34;: {
                                                        &#34;clusterName&#34;: &#34;sds-grpc&#34;
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                }
                            },
                            &#34;alpnProtocols&#34;: &amp;#91;
                                &#34;istio-peer-exchange&#34;,
                                &#34;h2&#34;,
                                &#34;http/1.1&#34;
                            ]
                        },
                        &#34;requireClientCertificate&#34;: true
                    }
                },
                &#34;name&#34;: &#34;virtualInbound&#34;
            },
            {
                &#34;filterChainMatch&#34;: {
                    &#34;prefixRanges&#34;: &amp;#91;
                        {
                            &#34;addressPrefix&#34;: &#34;0.0.0.0&#34;,
                            &#34;prefixLen&#34;: 0
                        }
                    ]
                },
                &#34;filters&#34;: &amp;#91;
                    {
                        &#34;name&#34;: &#34;istio.metadata_exchange&#34;,
                        &#34;typedConfig&#34;: {
                            &#34;@type&#34;: &#34;type.googleapis.com/udpa.type.v1.TypedStruct&#34;,
                            &#34;typeUrl&#34;: &#34;type.googleapis.com/envoy.tcp.metadataexchange.config.MetadataExchange&#34;,
                            &#34;value&#34;: {
                                &#34;protocol&#34;: &#34;istio-peer-exchange&#34;
                            }
                        }
                    },
                    {
                        &#34;name&#34;: &#34;istio.stats&#34;,
                        &#34;typedConfig&#34;: {
                            &#34;@type&#34;: &#34;type.googleapis.com/udpa.type.v1.TypedStruct&#34;,
                            &#34;typeUrl&#34;: &#34;type.googleapis.com/envoy.extensions.filters.network.wasm.v3.Wasm&#34;,
                            &#34;value&#34;: {
                                &#34;config&#34;: {
                                    &#34;configuration&#34;: &#34;{\n  \&#34;debug\&#34;: \&#34;false\&#34;,\n  \&#34;stat_prefix\&#34;: \&#34;istio\&#34;\n}\n&#34;,
                                    &#34;root_id&#34;: &#34;stats_inbound&#34;,
                                    &#34;vm_config&#34;: {
                                        &#34;code&#34;: {
                                            &#34;local&#34;: {
                                                &#34;inline_string&#34;: &#34;envoy.wasm.stats&#34;
                                            }
                                        },
                                        &#34;runtime&#34;: &#34;envoy.wasm.runtime.null&#34;,
                                        &#34;vm_id&#34;: &#34;tcp_stats_inbound&#34;
                                    }
                                }
                            }
                        }
                    },
                    {
                        &#34;name&#34;: &#34;envoy.tcp_proxy&#34;,
                        &#34;typedConfig&#34;: {
                            &#34;@type&#34;: &#34;type.googleapis.com/envoy.config.filter.network.tcp_proxy.v2.TcpProxy&#34;,
                            &#34;statPrefix&#34;: &#34;InboundPassthroughClusterIpv4&#34;,
                            &#34;cluster&#34;: &#34;InboundPassthroughClusterIpv4&#34;,
                            &#34;accessLog&#34;: &amp;#91;
                                {
                                    &#34;name&#34;: &#34;envoy.file_access_log&#34;,
                                    &#34;typedConfig&#34;: {
                                        &#34;@type&#34;: &#34;type.googleapis.com/envoy.config.accesslog.v2.FileAccessLog&#34;,
                                        &#34;path&#34;: &#34;/dev/stdout&#34;,
                                        &#34;format&#34;: &#34;&amp;#91;%START_TIME%] \&#34;%REQ(:METHOD)% %REQ(X-ENVOY-ORIGINAL-PATH?:PATH)% %PROTOCOL%\&#34; %RESPONSE_CODE% %RESPONSE_FLAGS% \&#34;%DYNAMIC_METADATA(istio.mixer:status)%\&#34; \&#34;%UPSTREAM_TRANSPORT_FAILURE_REASON%\&#34; %BYTES_RECEIVED% %BYTES_SENT% %DURATION% %RESP(X-ENVOY-UPSTREAM-SERVICE-TIME)% \&#34;%REQ(X-FORWARDED-FOR)%\&#34; \&#34;%REQ(USER-AGENT)%\&#34; \&#34;%REQ(X-REQUEST-ID)%\&#34; \&#34;%REQ(:AUTHORITY)%\&#34; \&#34;%UPSTREAM_HOST%\&#34; %UPSTREAM_CLUSTER% %UPSTREAM_LOCAL_ADDRESS% %DOWNSTREAM_LOCAL_ADDRESS% %DOWNSTREAM_REMOTE_ADDRESS% %REQUESTED_SERVER_NAME% %ROUTE_NAME%\n&#34;
                                    }
                                }
                            ]
                        }
                    }
                ],
                &#34;name&#34;: &#34;virtualInbound&#34;
            },
            {
                &#34;filterChainMatch&#34;: {
                    &#34;prefixRanges&#34;: &amp;#91;
                        {
                            &#34;addressPrefix&#34;: &#34;0.0.0.0&#34;,
                            &#34;prefixLen&#34;: 0
                        }
                    ],
                    &#34;transportProtocol&#34;: &#34;tls&#34;,
                    &#34;applicationProtocols&#34;: &amp;#91;
                        &#34;http/1.0&#34;,
                        &#34;http/1.1&#34;,
                        &#34;h2c&#34;,
                        &#34;istio-http/1.0&#34;,
                        &#34;istio-http/1.1&#34;,
                        &#34;istio-h2&#34;
                    ]
                },
                &#34;filters&#34;: &amp;#91;
                    {
                        &#34;name&#34;: &#34;istio.metadata_exchange&#34;,
                        &#34;typedConfig&#34;: {
                            &#34;@type&#34;: &#34;type.googleapis.com/udpa.type.v1.TypedStruct&#34;,
                            &#34;typeUrl&#34;: &#34;type.googleapis.com/envoy.tcp.metadataexchange.config.MetadataExchange&#34;,
                            &#34;value&#34;: {
                                &#34;protocol&#34;: &#34;istio-peer-exchange&#34;
                            }
                        }
                    },
                    {
                        &#34;name&#34;: &#34;envoy.http_connection_manager&#34;,
                        &#34;typedConfig&#34;: {
                            &#34;@type&#34;: &#34;type.googleapis.com/envoy.config.filter.network.http_connection_manager.v2.HttpConnectionManager&#34;,
                            &#34;statPrefix&#34;: &#34;InboundPassthroughClusterIpv4&#34;,
                            &#34;routeConfig&#34;: {
                                &#34;name&#34;: &#34;InboundPassthroughClusterIpv4&#34;,
                                &#34;virtualHosts&#34;: &amp;#91;
                                    {
                                        &#34;name&#34;: &#34;inbound|http|0&#34;,
                                        &#34;domains&#34;: &amp;#91;
                                            &#34;*&#34;
                                        ],
                                        &#34;routes&#34;: &amp;#91;
                                            {
                                                &#34;name&#34;: &#34;default&#34;,
                                                &#34;match&#34;: {
                                                    &#34;prefix&#34;: &#34;/&#34;
                                                },
                                                &#34;route&#34;: {
                                                    &#34;cluster&#34;: &#34;InboundPassthroughClusterIpv4&#34;,
                                                    &#34;timeout&#34;: &#34;0s&#34;,
                                                    &#34;maxGrpcTimeout&#34;: &#34;0s&#34;
                                                },
                                                &#34;decorator&#34;: {
                                                    &#34;operation&#34;: &#34;:0/*&#34;
                                                }
                                            }
                                        ]
                                    }
                                ],
                                &#34;validateClusters&#34;: false
                            },
                            &#34;httpFilters&#34;: &amp;#91;
                                {
                                    &#34;name&#34;: &#34;istio.metadata_exchange&#34;,
                                    &#34;typedConfig&#34;: {
                                        &#34;@type&#34;: &#34;type.googleapis.com/udpa.type.v1.TypedStruct&#34;,
                                        &#34;typeUrl&#34;: &#34;type.googleapis.com/envoy.extensions.filters.http.wasm.v3.Wasm&#34;,
                                        &#34;value&#34;: {
                                            &#34;config&#34;: {
                                                &#34;configuration&#34;: &#34;{}\n&#34;,
                                                &#34;vm_config&#34;: {
                                                    &#34;code&#34;: {
                                                        &#34;local&#34;: {
                                                            &#34;inline_string&#34;: &#34;envoy.wasm.metadata_exchange&#34;
                                                        }
                                                    },
                                                    &#34;runtime&#34;: &#34;envoy.wasm.runtime.null&#34;
                                                }
                                            }
                                        }
                                    }
                                },
                                {
                                    &#34;name&#34;: &#34;envoy.cors&#34;,
                                    &#34;typedConfig&#34;: {
                                        &#34;@type&#34;: &#34;type.googleapis.com/envoy.config.filter.http.cors.v2.Cors&#34;
                                    }
                                },
                                {
                                    &#34;name&#34;: &#34;envoy.fault&#34;,
                                    &#34;typedConfig&#34;: {
                                        &#34;@type&#34;: &#34;type.googleapis.com/envoy.config.filter.http.fault.v2.HTTPFault&#34;
                                    }
                                },
                                {
                                    &#34;name&#34;: &#34;istio.stats&#34;,
                                    &#34;typedConfig&#34;: {
                                        &#34;@type&#34;: &#34;type.googleapis.com/udpa.type.v1.TypedStruct&#34;,
                                        &#34;typeUrl&#34;: &#34;type.googleapis.com/envoy.extensions.filters.http.wasm.v3.Wasm&#34;,
                                        &#34;value&#34;: {
                                            &#34;config&#34;: {
                                                &#34;configuration&#34;: &#34;{\n  \&#34;debug\&#34;: \&#34;false\&#34;,\n  \&#34;stat_prefix\&#34;: \&#34;istio\&#34;\n}\n&#34;,
                                                &#34;root_id&#34;: &#34;stats_inbound&#34;,
                                                &#34;vm_config&#34;: {
                                                    &#34;code&#34;: {
                                                        &#34;local&#34;: {
                                                            &#34;inline_string&#34;: &#34;envoy.wasm.stats&#34;
                                                        }
                                                    },
                                                    &#34;runtime&#34;: &#34;envoy.wasm.runtime.null&#34;,
                                                    &#34;vm_id&#34;: &#34;stats_inbound&#34;
                                                }
                                            }
                                        }
                                    }
                                },
                                {
                                    &#34;name&#34;: &#34;envoy.router&#34;,
                                    &#34;typedConfig&#34;: {
                                        &#34;@type&#34;: &#34;type.googleapis.com/envoy.config.filter.http.router.v2.Router&#34;
                                    }
                                }
                            ],
                            &#34;tracing&#34;: {
                                &#34;clientSampling&#34;: {
                                    &#34;value&#34;: 100
                                },
                                &#34;randomSampling&#34;: {
                                    &#34;value&#34;: 100
                                },
                                &#34;overallSampling&#34;: {
                                    &#34;value&#34;: 100
                                }
                            },
                            &#34;serverName&#34;: &#34;istio-envoy&#34;,
                            &#34;streamIdleTimeout&#34;: &#34;0s&#34;,
                            &#34;accessLog&#34;: &amp;#91;
                                {
                                    &#34;name&#34;: &#34;envoy.file_access_log&#34;,
                                    &#34;typedConfig&#34;: {
                                        &#34;@type&#34;: &#34;type.googleapis.com/envoy.config.accesslog.v2.FileAccessLog&#34;,
                                        &#34;path&#34;: &#34;/dev/stdout&#34;,
                                        &#34;format&#34;: &#34;&amp;#91;%START_TIME%] \&#34;%REQ(:METHOD)% %REQ(X-ENVOY-ORIGINAL-PATH?:PATH)% %PROTOCOL%\&#34; %RESPONSE_CODE% %RESPONSE_FLAGS% \&#34;%DYNAMIC_METADATA(istio.mixer:status)%\&#34; \&#34;%UPSTREAM_TRANSPORT_FAILURE_REASON%\&#34; %BYTES_RECEIVED% %BYTES_SENT% %DURATION% %RESP(X-ENVOY-UPSTREAM-SERVICE-TIME)% \&#34;%REQ(X-FORWARDED-FOR)%\&#34; \&#34;%REQ(USER-AGENT)%\&#34; \&#34;%REQ(X-REQUEST-ID)%\&#34; \&#34;%REQ(:AUTHORITY)%\&#34; \&#34;%UPSTREAM_HOST%\&#34; %UPSTREAM_CLUSTER% %UPSTREAM_LOCAL_ADDRESS% %DOWNSTREAM_LOCAL_ADDRESS% %DOWNSTREAM_REMOTE_ADDRESS% %REQUESTED_SERVER_NAME% %ROUTE_NAME%\n&#34;
                                    }
                                }
                            ],
                            &#34;useRemoteAddress&#34;: false,
                            &#34;generateRequestId&#34;: true,
                            &#34;forwardClientCertDetails&#34;: &#34;APPEND_FORWARD&#34;,
                            &#34;setCurrentClientCertDetails&#34;: {
                                &#34;subject&#34;: true,
                                &#34;dns&#34;: true,
                                &#34;uri&#34;: true
                            },
                            &#34;upgradeConfigs&#34;: &amp;#91;
                                {
                                    &#34;upgradeType&#34;: &#34;websocket&#34;
                                }
                            ],
                            &#34;normalizePath&#34;: true
                        }
                    }
                ],
                &#34;transportSocket&#34;: {
                    &#34;name&#34;: &#34;envoy.transport_sockets.tls&#34;,
                    &#34;typedConfig&#34;: {
                        &#34;@type&#34;: &#34;type.googleapis.com/envoy.api.v2.auth.DownstreamTlsContext&#34;,
                        &#34;commonTlsContext&#34;: {
                            &#34;tlsCertificateSdsSecretConfigs&#34;: &amp;#91;
                                {
                                    &#34;name&#34;: &#34;default&#34;,
                                    &#34;sdsConfig&#34;: {
                                        &#34;apiConfigSource&#34;: {
                                            &#34;apiType&#34;: &#34;GRPC&#34;,
                                            &#34;grpcServices&#34;: &amp;#91;
                                                {
                                                    &#34;envoyGrpc&#34;: {
                                                        &#34;clusterName&#34;: &#34;sds-grpc&#34;
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                }
                            ],
                            &#34;combinedValidationContext&#34;: {
                                &#34;defaultValidationContext&#34;: {},
                                &#34;validationContextSdsSecretConfig&#34;: {
                                    &#34;name&#34;: &#34;ROOTCA&#34;,
                                    &#34;sdsConfig&#34;: {
                                        &#34;apiConfigSource&#34;: {
                                            &#34;apiType&#34;: &#34;GRPC&#34;,
                                            &#34;grpcServices&#34;: &amp;#91;
                                                {
                                                    &#34;envoyGrpc&#34;: {
                                                        &#34;clusterName&#34;: &#34;sds-grpc&#34;
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                }
                            },
                            &#34;alpnProtocols&#34;: &amp;#91;
                                &#34;h2&#34;,
                                &#34;http/1.1&#34;
                            ]
                        },
                        &#34;requireClientCertificate&#34;: true
                    }
                },
                &#34;name&#34;: &#34;virtualInbound-catchall-http&#34;
            },
            {
                &#34;filterChainMatch&#34;: {
                    &#34;prefixRanges&#34;: &amp;#91;
                        {
                            &#34;addressPrefix&#34;: &#34;0.0.0.0&#34;,
                            &#34;prefixLen&#34;: 0
                        }
                    ],
                    &#34;applicationProtocols&#34;: &amp;#91;
                        &#34;http/1.0&#34;,
                        &#34;http/1.1&#34;,
                        &#34;h2c&#34;
                    ]
                },
                &#34;filters&#34;: &amp;#91;
                    {
                        &#34;name&#34;: &#34;istio.metadata_exchange&#34;,
                        &#34;typedConfig&#34;: {
                            &#34;@type&#34;: &#34;type.googleapis.com/udpa.type.v1.TypedStruct&#34;,
                            &#34;typeUrl&#34;: &#34;type.googleapis.com/envoy.tcp.metadataexchange.config.MetadataExchange&#34;,
                            &#34;value&#34;: {
                                &#34;protocol&#34;: &#34;istio-peer-exchange&#34;
                            }
                        }
                    },
                    {
                        &#34;name&#34;: &#34;envoy.http_connection_manager&#34;,
                        &#34;typedConfig&#34;: {
                            &#34;@type&#34;: &#34;type.googleapis.com/envoy.config.filter.network.http_connection_manager.v2.HttpConnectionManager&#34;,
                            &#34;statPrefix&#34;: &#34;InboundPassthroughClusterIpv4&#34;,
                            &#34;routeConfig&#34;: {
                                &#34;name&#34;: &#34;InboundPassthroughClusterIpv4&#34;,
                                &#34;virtualHosts&#34;: &amp;#91;
                                    {
                                        &#34;name&#34;: &#34;inbound|http|0&#34;,
                                        &#34;domains&#34;: &amp;#91;
                                            &#34;*&#34;
                                        ],
                                        &#34;routes&#34;: &amp;#91;
                                            {
                                                &#34;name&#34;: &#34;default&#34;,
                                                &#34;match&#34;: {
                                                    &#34;prefix&#34;: &#34;/&#34;
                                                },
                                                &#34;route&#34;: {
                                                    &#34;cluster&#34;: &#34;InboundPassthroughClusterIpv4&#34;,
                                                    &#34;timeout&#34;: &#34;0s&#34;,
                                                    &#34;maxGrpcTimeout&#34;: &#34;0s&#34;
                                                },
                                                &#34;decorator&#34;: {
                                                    &#34;operation&#34;: &#34;:0/*&#34;
                                                }
                                            }
                                        ]
                                    }
                                ],
                                &#34;validateClusters&#34;: false
                            },
                            &#34;httpFilters&#34;: &amp;#91;
                                {
                                    &#34;name&#34;: &#34;istio.metadata_exchange&#34;,
                                    &#34;typedConfig&#34;: {
                                        &#34;@type&#34;: &#34;type.googleapis.com/udpa.type.v1.TypedStruct&#34;,
                                        &#34;typeUrl&#34;: &#34;type.googleapis.com/envoy.extensions.filters.http.wasm.v3.Wasm&#34;,
                                        &#34;value&#34;: {
                                            &#34;config&#34;: {
                                                &#34;configuration&#34;: &#34;{}\n&#34;,
                                                &#34;vm_config&#34;: {
                                                    &#34;code&#34;: {
                                                        &#34;local&#34;: {
                                                            &#34;inline_string&#34;: &#34;envoy.wasm.metadata_exchange&#34;
                                                        }
                                                    },
                                                    &#34;runtime&#34;: &#34;envoy.wasm.runtime.null&#34;
                                                }
                                            }
                                        }
                                    }
                                },
                                {
                                    &#34;name&#34;: &#34;envoy.cors&#34;,
                                    &#34;typedConfig&#34;: {
                                        &#34;@type&#34;: &#34;type.googleapis.com/envoy.config.filter.http.cors.v2.Cors&#34;
                                    }
                                },
                                {
                                    &#34;name&#34;: &#34;envoy.fault&#34;,
                                    &#34;typedConfig&#34;: {
                                        &#34;@type&#34;: &#34;type.googleapis.com/envoy.config.filter.http.fault.v2.HTTPFault&#34;
                                    }
                                },
                                {
                                    &#34;name&#34;: &#34;istio.stats&#34;,
                                    &#34;typedConfig&#34;: {
                                        &#34;@type&#34;: &#34;type.googleapis.com/udpa.type.v1.TypedStruct&#34;,
                                        &#34;typeUrl&#34;: &#34;type.googleapis.com/envoy.extensions.filters.http.wasm.v3.Wasm&#34;,
                                        &#34;value&#34;: {
                                            &#34;config&#34;: {
                                                &#34;configuration&#34;: &#34;{\n  \&#34;debug\&#34;: \&#34;false\&#34;,\n  \&#34;stat_prefix\&#34;: \&#34;istio\&#34;\n}\n&#34;,
                                                &#34;root_id&#34;: &#34;stats_inbound&#34;,
                                                &#34;vm_config&#34;: {
                                                    &#34;code&#34;: {
                                                        &#34;local&#34;: {
                                                            &#34;inline_string&#34;: &#34;envoy.wasm.stats&#34;
                                                        }
                                                    },
                                                    &#34;runtime&#34;: &#34;envoy.wasm.runtime.null&#34;,
                                                    &#34;vm_id&#34;: &#34;stats_inbound&#34;
                                                }
                                            }
                                        }
                                    }
                                },
                                {
                                    &#34;name&#34;: &#34;envoy.router&#34;,
                                    &#34;typedConfig&#34;: {
                                        &#34;@type&#34;: &#34;type.googleapis.com/envoy.config.filter.http.router.v2.Router&#34;
                                    }
                                }
                            ],
                            &#34;tracing&#34;: {
                                &#34;clientSampling&#34;: {
                                    &#34;value&#34;: 100
                                },
                                &#34;randomSampling&#34;: {
                                    &#34;value&#34;: 100
                                },
                                &#34;overallSampling&#34;: {
                                    &#34;value&#34;: 100
                                }
                            },
                            &#34;serverName&#34;: &#34;istio-envoy&#34;,
                            &#34;streamIdleTimeout&#34;: &#34;0s&#34;,
                            &#34;accessLog&#34;: &amp;#91;
                                {
                                    &#34;name&#34;: &#34;envoy.file_access_log&#34;,
                                    &#34;typedConfig&#34;: {
                                        &#34;@type&#34;: &#34;type.googleapis.com/envoy.config.accesslog.v2.FileAccessLog&#34;,
                                        &#34;path&#34;: &#34;/dev/stdout&#34;,
                                        &#34;format&#34;: &#34;&amp;#91;%START_TIME%] \&#34;%REQ(:METHOD)% %REQ(X-ENVOY-ORIGINAL-PATH?:PATH)% %PROTOCOL%\&#34; %RESPONSE_CODE% %RESPONSE_FLAGS% \&#34;%DYNAMIC_METADATA(istio.mixer:status)%\&#34; \&#34;%UPSTREAM_TRANSPORT_FAILURE_REASON%\&#34; %BYTES_RECEIVED% %BYTES_SENT% %DURATION% %RESP(X-ENVOY-UPSTREAM-SERVICE-TIME)% \&#34;%REQ(X-FORWARDED-FOR)%\&#34; \&#34;%REQ(USER-AGENT)%\&#34; \&#34;%REQ(X-REQUEST-ID)%\&#34; \&#34;%REQ(:AUTHORITY)%\&#34; \&#34;%UPSTREAM_HOST%\&#34; %UPSTREAM_CLUSTER% %UPSTREAM_LOCAL_ADDRESS% %DOWNSTREAM_LOCAL_ADDRESS% %DOWNSTREAM_REMOTE_ADDRESS% %REQUESTED_SERVER_NAME% %ROUTE_NAME%\n&#34;
                                    }
                                }
                            ],
                            &#34;useRemoteAddress&#34;: false,
                            &#34;generateRequestId&#34;: true,
                            &#34;forwardClientCertDetails&#34;: &#34;APPEND_FORWARD&#34;,
                            &#34;setCurrentClientCertDetails&#34;: {
                                &#34;subject&#34;: true,
                                &#34;dns&#34;: true,
                                &#34;uri&#34;: true
                            },
                            &#34;upgradeConfigs&#34;: &amp;#91;
                                {
                                    &#34;upgradeType&#34;: &#34;websocket&#34;
                                }
                            ],
                            &#34;normalizePath&#34;: true
                        }
                    }
                ],
                &#34;name&#34;: &#34;virtualInbound-catchall-http&#34;
            },
            {
                &#34;filterChainMatch&#34;: {
                    &#34;destinationPort&#34;: 15021,
                    &#34;prefixRanges&#34;: &amp;#91;
                        {
                            &#34;addressPrefix&#34;: &#34;10.244.2.155&#34;,
                            &#34;prefixLen&#34;: 32
                        }
                    ]
                },
                &#34;filters&#34;: &amp;#91;
                    {
                        &#34;name&#34;: &#34;istio.metadata_exchange&#34;,
                        &#34;typedConfig&#34;: {
                            &#34;@type&#34;: &#34;type.googleapis.com/udpa.type.v1.TypedStruct&#34;,
                            &#34;typeUrl&#34;: &#34;type.googleapis.com/envoy.tcp.metadataexchange.config.MetadataExchange&#34;,
                            &#34;value&#34;: {
                                &#34;protocol&#34;: &#34;istio-peer-exchange&#34;
                            }
                        }
                    },
                    {
                        &#34;name&#34;: &#34;istio.stats&#34;,
                        &#34;typedConfig&#34;: {
                            &#34;@type&#34;: &#34;type.googleapis.com/udpa.type.v1.TypedStruct&#34;,
                            &#34;typeUrl&#34;: &#34;type.googleapis.com/envoy.extensions.filters.network.wasm.v3.Wasm&#34;,
                            &#34;value&#34;: {
                                &#34;config&#34;: {
                                    &#34;configuration&#34;: &#34;{\n  \&#34;debug\&#34;: \&#34;false\&#34;,\n  \&#34;stat_prefix\&#34;: \&#34;istio\&#34;\n}\n&#34;,
                                    &#34;root_id&#34;: &#34;stats_inbound&#34;,
                                    &#34;vm_config&#34;: {
                                        &#34;code&#34;: {
                                            &#34;local&#34;: {
                                                &#34;inline_string&#34;: &#34;envoy.wasm.stats&#34;
                                            }
                                        },
                                        &#34;runtime&#34;: &#34;envoy.wasm.runtime.null&#34;,
                                        &#34;vm_id&#34;: &#34;tcp_stats_inbound&#34;
                                    }
                                }
                            }
                        }
                    },
                    {
                        &#34;name&#34;: &#34;envoy.tcp_proxy&#34;,
                        &#34;typedConfig&#34;: {
                            &#34;@type&#34;: &#34;type.googleapis.com/envoy.config.filter.network.tcp_proxy.v2.TcpProxy&#34;,
                            &#34;statPrefix&#34;: &#34;inbound|15021|mgmt-15021|mgmtCluster&#34;,
                            &#34;cluster&#34;: &#34;inbound|15021|mgmt-15021|mgmtCluster&#34;,
                            &#34;accessLog&#34;: &amp;#91;
                                {
                                    &#34;name&#34;: &#34;envoy.file_access_log&#34;,
                                    &#34;typedConfig&#34;: {
                                        &#34;@type&#34;: &#34;type.googleapis.com/envoy.config.accesslog.v2.FileAccessLog&#34;,
                                        &#34;path&#34;: &#34;/dev/stdout&#34;,
                                        &#34;format&#34;: &#34;&amp;#91;%START_TIME%] \&#34;%REQ(:METHOD)% %REQ(X-ENVOY-ORIGINAL-PATH?:PATH)% %PROTOCOL%\&#34; %RESPONSE_CODE% %RESPONSE_FLAGS% \&#34;%DYNAMIC_METADATA(istio.mixer:status)%\&#34; \&#34;%UPSTREAM_TRANSPORT_FAILURE_REASON%\&#34; %BYTES_RECEIVED% %BYTES_SENT% %DURATION% %RESP(X-ENVOY-UPSTREAM-SERVICE-TIME)% \&#34;%REQ(X-FORWARDED-FOR)%\&#34; \&#34;%REQ(USER-AGENT)%\&#34; \&#34;%REQ(X-REQUEST-ID)%\&#34; \&#34;%REQ(:AUTHORITY)%\&#34; \&#34;%UPSTREAM_HOST%\&#34; %UPSTREAM_CLUSTER% %UPSTREAM_LOCAL_ADDRESS% %DOWNSTREAM_LOCAL_ADDRESS% %DOWNSTREAM_REMOTE_ADDRESS% %REQUESTED_SERVER_NAME% %ROUTE_NAME%\n&#34;
                                    }
                                }
                            ]
                        }
                    }
                ],
                &#34;name&#34;: &#34;10.244.2.155_15021&#34;
            },
            {
                &#34;filterChainMatch&#34;: {
                    &#34;destinationPort&#34;: 9080,
                    &#34;prefixRanges&#34;: &amp;#91;
                        {
                            &#34;addressPrefix&#34;: &#34;10.244.2.155&#34;,
                            &#34;prefixLen&#34;: 32
                        }
                    ],
                    &#34;applicationProtocols&#34;: &amp;#91;
                        &#34;istio&#34;,
                        &#34;istio-http/1.0&#34;,
                        &#34;istio-http/1.1&#34;,
                        &#34;istio-h2&#34;
                    ]
                },
                &#34;filters&#34;: &amp;#91;
                    {
                        &#34;name&#34;: &#34;istio.metadata_exchange&#34;,
                        &#34;typedConfig&#34;: {
                            &#34;@type&#34;: &#34;type.googleapis.com/udpa.type.v1.TypedStruct&#34;,
                            &#34;typeUrl&#34;: &#34;type.googleapis.com/envoy.tcp.metadataexchange.config.MetadataExchange&#34;,
                            &#34;value&#34;: {
                                &#34;protocol&#34;: &#34;istio-peer-exchange&#34;
                            }
                        }
                    },
                    {
                        &#34;name&#34;: &#34;envoy.http_connection_manager&#34;,
                        &#34;typedConfig&#34;: {
                            &#34;@type&#34;: &#34;type.googleapis.com/envoy.config.filter.network.http_connection_manager.v2.HttpConnectionManager&#34;,
                            &#34;statPrefix&#34;: &#34;inbound_10.244.2.155_9080&#34;,
                            &#34;routeConfig&#34;: {
                                &#34;name&#34;: &#34;inbound|9080|http|productpage.istio-bookinfo.svc.cluster.local&#34;,
                                &#34;virtualHosts&#34;: &amp;#91;
                                    {
                                        &#34;name&#34;: &#34;inbound|http|9080&#34;,
                                        &#34;domains&#34;: &amp;#91;
                                            &#34;*&#34;
                                        ],
                                        &#34;routes&#34;: &amp;#91;
                                            {
                                                &#34;name&#34;: &#34;default&#34;,
                                                &#34;match&#34;: {
                                                    &#34;prefix&#34;: &#34;/&#34;
                                                },
                                                &#34;route&#34;: {
                                                    &#34;cluster&#34;: &#34;inbound|9080|http|productpage.istio-bookinfo.svc.cluster.local&#34;,
                                                    &#34;timeout&#34;: &#34;0s&#34;,
                                                    &#34;maxGrpcTimeout&#34;: &#34;0s&#34;
                                                },
                                                &#34;decorator&#34;: {
                                                    &#34;operation&#34;: &#34;productpage.istio-bookinfo.svc.cluster.local:9080/*&#34;
                                                }
                                            }
                                        ]
                                    }
                                ],
                                &#34;validateClusters&#34;: false
                            },
                            &#34;httpFilters&#34;: &amp;#91;
                                {
                                    &#34;name&#34;: &#34;istio.metadata_exchange&#34;,
                                    &#34;typedConfig&#34;: {
                                        &#34;@type&#34;: &#34;type.googleapis.com/udpa.type.v1.TypedStruct&#34;,
                                        &#34;typeUrl&#34;: &#34;type.googleapis.com/envoy.extensions.filters.http.wasm.v3.Wasm&#34;,
                                        &#34;value&#34;: {
                                            &#34;config&#34;: {
                                                &#34;configuration&#34;: &#34;{}\n&#34;,
                                                &#34;vm_config&#34;: {
                                                    &#34;code&#34;: {
                                                        &#34;local&#34;: {
                                                            &#34;inline_string&#34;: &#34;envoy.wasm.metadata_exchange&#34;
                                                        }
                                                    },
                                                    &#34;runtime&#34;: &#34;envoy.wasm.runtime.null&#34;
                                                }
                                            }
                                        }
                                    }
                                },
                                {
                                    &#34;name&#34;: &#34;istio_authn&#34;,
                                    &#34;typedConfig&#34;: {
                                        &#34;@type&#34;: &#34;type.googleapis.com/istio.envoy.config.filter.http.authn.v2alpha1.FilterConfig&#34;,
                                        &#34;policy&#34;: {
                                            &#34;peers&#34;: &amp;#91;
                                                {
                                                    &#34;mtls&#34;: {
                                                        &#34;mode&#34;: &#34;PERMISSIVE&#34;
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    &#34;name&#34;: &#34;envoy.cors&#34;,
                                    &#34;typedConfig&#34;: {
                                        &#34;@type&#34;: &#34;type.googleapis.com/envoy.config.filter.http.cors.v2.Cors&#34;
                                    }
                                },
                                {
                                    &#34;name&#34;: &#34;envoy.fault&#34;,
                                    &#34;typedConfig&#34;: {
                                        &#34;@type&#34;: &#34;type.googleapis.com/envoy.config.filter.http.fault.v2.HTTPFault&#34;
                                    }
                                },
                                {
                                    &#34;name&#34;: &#34;istio.stats&#34;,
                                    &#34;typedConfig&#34;: {
                                        &#34;@type&#34;: &#34;type.googleapis.com/udpa.type.v1.TypedStruct&#34;,
                                        &#34;typeUrl&#34;: &#34;type.googleapis.com/envoy.extensions.filters.http.wasm.v3.Wasm&#34;,
                                        &#34;value&#34;: {
                                            &#34;config&#34;: {
                                                &#34;configuration&#34;: &#34;{\n  \&#34;debug\&#34;: \&#34;false\&#34;,\n  \&#34;stat_prefix\&#34;: \&#34;istio\&#34;\n}\n&#34;,
                                                &#34;root_id&#34;: &#34;stats_inbound&#34;,
                                                &#34;vm_config&#34;: {
                                                    &#34;code&#34;: {
                                                        &#34;local&#34;: {
                                                            &#34;inline_string&#34;: &#34;envoy.wasm.stats&#34;
                                                        }
                                                    },
                                                    &#34;runtime&#34;: &#34;envoy.wasm.runtime.null&#34;,
                                                    &#34;vm_id&#34;: &#34;stats_inbound&#34;
                                                }
                                            }
                                        }
                                    }
                                },
                                {
                                    &#34;name&#34;: &#34;envoy.router&#34;,
                                    &#34;typedConfig&#34;: {
                                        &#34;@type&#34;: &#34;type.googleapis.com/envoy.config.filter.http.router.v2.Router&#34;
                                    }
                                }
                            ],
                            &#34;tracing&#34;: {
                                &#34;clientSampling&#34;: {
                                    &#34;value&#34;: 100
                                },
                                &#34;randomSampling&#34;: {
                                    &#34;value&#34;: 100
                                },
                                &#34;overallSampling&#34;: {
                                    &#34;value&#34;: 100
                                }
                            },
                            &#34;serverName&#34;: &#34;istio-envoy&#34;,
                            &#34;streamIdleTimeout&#34;: &#34;0s&#34;,
                            &#34;accessLog&#34;: &amp;#91;
                                {
                                    &#34;name&#34;: &#34;envoy.file_access_log&#34;,
                                    &#34;typedConfig&#34;: {
                                        &#34;@type&#34;: &#34;type.googleapis.com/envoy.config.accesslog.v2.FileAccessLog&#34;,
                                        &#34;path&#34;: &#34;/dev/stdout&#34;,
                                        &#34;format&#34;: &#34;&amp;#91;%START_TIME%] \&#34;%REQ(:METHOD)% %REQ(X-ENVOY-ORIGINAL-PATH?:PATH)% %PROTOCOL%\&#34; %RESPONSE_CODE% %RESPONSE_FLAGS% \&#34;%DYNAMIC_METADATA(istio.mixer:status)%\&#34; \&#34;%UPSTREAM_TRANSPORT_FAILURE_REASON%\&#34; %BYTES_RECEIVED% %BYTES_SENT% %DURATION% %RESP(X-ENVOY-UPSTREAM-SERVICE-TIME)% \&#34;%REQ(X-FORWARDED-FOR)%\&#34; \&#34;%REQ(USER-AGENT)%\&#34; \&#34;%REQ(X-REQUEST-ID)%\&#34; \&#34;%REQ(:AUTHORITY)%\&#34; \&#34;%UPSTREAM_HOST%\&#34; %UPSTREAM_CLUSTER% %UPSTREAM_LOCAL_ADDRESS% %DOWNSTREAM_LOCAL_ADDRESS% %DOWNSTREAM_REMOTE_ADDRESS% %REQUESTED_SERVER_NAME% %ROUTE_NAME%\n&#34;
                                    }
                                }
                            ],
                            &#34;useRemoteAddress&#34;: false,
                            &#34;generateRequestId&#34;: true,
                            &#34;forwardClientCertDetails&#34;: &#34;APPEND_FORWARD&#34;,
                            &#34;setCurrentClientCertDetails&#34;: {
                                &#34;subject&#34;: true,
                                &#34;dns&#34;: true,
                                &#34;uri&#34;: true
                            },
                            &#34;upgradeConfigs&#34;: &amp;#91;
                                {
                                    &#34;upgradeType&#34;: &#34;websocket&#34;
                                }
                            ],
                            &#34;normalizePath&#34;: true
                        }
                    }
                ],
                &#34;transportSocket&#34;: {
                    &#34;name&#34;: &#34;envoy.transport_sockets.tls&#34;,
                    &#34;typedConfig&#34;: {
                        &#34;@type&#34;: &#34;type.googleapis.com/envoy.api.v2.auth.DownstreamTlsContext&#34;,
                        &#34;commonTlsContext&#34;: {
                            &#34;tlsCertificateSdsSecretConfigs&#34;: &amp;#91;
                                {
                                    &#34;name&#34;: &#34;default&#34;,
                                    &#34;sdsConfig&#34;: {
                                        &#34;apiConfigSource&#34;: {
                                            &#34;apiType&#34;: &#34;GRPC&#34;,
                                            &#34;grpcServices&#34;: &amp;#91;
                                                {
                                                    &#34;envoyGrpc&#34;: {
                                                        &#34;clusterName&#34;: &#34;sds-grpc&#34;
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                }
                            ],
                            &#34;combinedValidationContext&#34;: {
                                &#34;defaultValidationContext&#34;: {},
                                &#34;validationContextSdsSecretConfig&#34;: {
                                    &#34;name&#34;: &#34;ROOTCA&#34;,
                                    &#34;sdsConfig&#34;: {
                                        &#34;apiConfigSource&#34;: {
                                            &#34;apiType&#34;: &#34;GRPC&#34;,
                                            &#34;grpcServices&#34;: &amp;#91;
                                                {
                                                    &#34;envoyGrpc&#34;: {
                                                        &#34;clusterName&#34;: &#34;sds-grpc&#34;
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                }
                            },
                            &#34;alpnProtocols&#34;: &amp;#91;
                                &#34;h2&#34;,
                                &#34;http/1.1&#34;
                            ]
                        },
                        &#34;requireClientCertificate&#34;: true
                    }
                },
                &#34;name&#34;: &#34;10.244.2.155_9080&#34;
            },
            {
                &#34;filterChainMatch&#34;: {
                    &#34;destinationPort&#34;: 9080,
                    &#34;prefixRanges&#34;: &amp;#91;
                        {
                            &#34;addressPrefix&#34;: &#34;10.244.2.155&#34;,
                            &#34;prefixLen&#34;: 32
                        }
                    ]
                },
                &#34;filters&#34;: &amp;#91;
                    {
                        &#34;name&#34;: &#34;istio.metadata_exchange&#34;,
                        &#34;typedConfig&#34;: {
                            &#34;@type&#34;: &#34;type.googleapis.com/udpa.type.v1.TypedStruct&#34;,
                            &#34;typeUrl&#34;: &#34;type.googleapis.com/envoy.tcp.metadataexchange.config.MetadataExchange&#34;,
                            &#34;value&#34;: {
                                &#34;protocol&#34;: &#34;istio-peer-exchange&#34;
                            }
                        }
                    },
                    {
                        &#34;name&#34;: &#34;envoy.http_connection_manager&#34;,
                        &#34;typedConfig&#34;: {
                            &#34;@type&#34;: &#34;type.googleapis.com/envoy.config.filter.network.http_connection_manager.v2.HttpConnectionManager&#34;,
                            &#34;statPrefix&#34;: &#34;inbound_10.244.2.155_9080&#34;,
                            &#34;routeConfig&#34;: {
                                &#34;name&#34;: &#34;inbound|9080|http|productpage.istio-bookinfo.svc.cluster.local&#34;,
                                &#34;virtualHosts&#34;: &amp;#91;
                                    {
                                        &#34;name&#34;: &#34;inbound|http|9080&#34;,
                                        &#34;domains&#34;: &amp;#91;
                                            &#34;*&#34;
                                        ],
                                        &#34;routes&#34;: &amp;#91;
                                            {
                                                &#34;name&#34;: &#34;default&#34;,
                                                &#34;match&#34;: {
                                                    &#34;prefix&#34;: &#34;/&#34;
                                                },
                                                &#34;route&#34;: {
                                                    &#34;cluster&#34;: &#34;inbound|9080|http|productpage.istio-bookinfo.svc.cluster.local&#34;,
                                                    &#34;timeout&#34;: &#34;0s&#34;,
                                                    &#34;maxGrpcTimeout&#34;: &#34;0s&#34;
                                                },
                                                &#34;decorator&#34;: {
                                                    &#34;operation&#34;: &#34;productpage.istio-bookinfo.svc.cluster.local:9080/*&#34;
                                                }
                                            }
                                        ]
                                    }
                                ],
                                &#34;validateClusters&#34;: false
                            },
                            &#34;httpFilters&#34;: &amp;#91;
                                {
                                    &#34;name&#34;: &#34;istio.metadata_exchange&#34;,
                                    &#34;typedConfig&#34;: {
                                        &#34;@type&#34;: &#34;type.googleapis.com/udpa.type.v1.TypedStruct&#34;,
                                        &#34;typeUrl&#34;: &#34;type.googleapis.com/envoy.extensions.filters.http.wasm.v3.Wasm&#34;,
                                        &#34;value&#34;: {
                                            &#34;config&#34;: {
                                                &#34;configuration&#34;: &#34;{}\n&#34;,
                                                &#34;vm_config&#34;: {
                                                    &#34;code&#34;: {
                                                        &#34;local&#34;: {
                                                            &#34;inline_string&#34;: &#34;envoy.wasm.metadata_exchange&#34;
                                                        }
                                                    },
                                                    &#34;runtime&#34;: &#34;envoy.wasm.runtime.null&#34;
                                                }
                                            }
                                        }
                                    }
                                },
                                {
                                    &#34;name&#34;: &#34;istio_authn&#34;,
                                    &#34;typedConfig&#34;: {
                                        &#34;@type&#34;: &#34;type.googleapis.com/istio.envoy.config.filter.http.authn.v2alpha1.FilterConfig&#34;,
                                        &#34;policy&#34;: {
                                            &#34;peers&#34;: &amp;#91;
                                                {
                                                    &#34;mtls&#34;: {
                                                        &#34;mode&#34;: &#34;PERMISSIVE&#34;
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    &#34;name&#34;: &#34;envoy.cors&#34;,
                                    &#34;typedConfig&#34;: {
                                        &#34;@type&#34;: &#34;type.googleapis.com/envoy.config.filter.http.cors.v2.Cors&#34;
                                    }
                                },
                                {
                                    &#34;name&#34;: &#34;envoy.fault&#34;,
                                    &#34;typedConfig&#34;: {
                                        &#34;@type&#34;: &#34;type.googleapis.com/envoy.config.filter.http.fault.v2.HTTPFault&#34;
                                    }
                                },
                                {
                                    &#34;name&#34;: &#34;istio.stats&#34;,
                                    &#34;typedConfig&#34;: {
                                        &#34;@type&#34;: &#34;type.googleapis.com/udpa.type.v1.TypedStruct&#34;,
                                        &#34;typeUrl&#34;: &#34;type.googleapis.com/envoy.extensions.filters.http.wasm.v3.Wasm&#34;,
                                        &#34;value&#34;: {
                                            &#34;config&#34;: {
                                                &#34;configuration&#34;: &#34;{\n  \&#34;debug\&#34;: \&#34;false\&#34;,\n  \&#34;stat_prefix\&#34;: \&#34;istio\&#34;\n}\n&#34;,
                                                &#34;root_id&#34;: &#34;stats_inbound&#34;,
                                                &#34;vm_config&#34;: {
                                                    &#34;code&#34;: {
                                                        &#34;local&#34;: {
                                                            &#34;inline_string&#34;: &#34;envoy.wasm.stats&#34;
                                                        }
                                                    },
                                                    &#34;runtime&#34;: &#34;envoy.wasm.runtime.null&#34;,
                                                    &#34;vm_id&#34;: &#34;stats_inbound&#34;
                                                }
                                            }
                                        }
                                    }
                                },
                                {
                                    &#34;name&#34;: &#34;envoy.router&#34;,
                                    &#34;typedConfig&#34;: {
                                        &#34;@type&#34;: &#34;type.googleapis.com/envoy.config.filter.http.router.v2.Router&#34;
                                    }
                                }
                            ],
                            &#34;tracing&#34;: {
                                &#34;clientSampling&#34;: {
                                    &#34;value&#34;: 100
                                },
                                &#34;randomSampling&#34;: {
                                    &#34;value&#34;: 100
                                },
                                &#34;overallSampling&#34;: {
                                    &#34;value&#34;: 100
                                }
                            },
                            &#34;serverName&#34;: &#34;istio-envoy&#34;,
                            &#34;streamIdleTimeout&#34;: &#34;0s&#34;,
                            &#34;accessLog&#34;: &amp;#91;
                                {
                                    &#34;name&#34;: &#34;envoy.file_access_log&#34;,
                                    &#34;typedConfig&#34;: {
                                        &#34;@type&#34;: &#34;type.googleapis.com/envoy.config.accesslog.v2.FileAccessLog&#34;,
                                        &#34;path&#34;: &#34;/dev/stdout&#34;,
                                        &#34;format&#34;: &#34;&amp;#91;%START_TIME%] \&#34;%REQ(:METHOD)% %REQ(X-ENVOY-ORIGINAL-PATH?:PATH)% %PROTOCOL%\&#34; %RESPONSE_CODE% %RESPONSE_FLAGS% \&#34;%DYNAMIC_METADATA(istio.mixer:status)%\&#34; \&#34;%UPSTREAM_TRANSPORT_FAILURE_REASON%\&#34; %BYTES_RECEIVED% %BYTES_SENT% %DURATION% %RESP(X-ENVOY-UPSTREAM-SERVICE-TIME)% \&#34;%REQ(X-FORWARDED-FOR)%\&#34; \&#34;%REQ(USER-AGENT)%\&#34; \&#34;%REQ(X-REQUEST-ID)%\&#34; \&#34;%REQ(:AUTHORITY)%\&#34; \&#34;%UPSTREAM_HOST%\&#34; %UPSTREAM_CLUSTER% %UPSTREAM_LOCAL_ADDRESS% %DOWNSTREAM_LOCAL_ADDRESS% %DOWNSTREAM_REMOTE_ADDRESS% %REQUESTED_SERVER_NAME% %ROUTE_NAME%\n&#34;
                                    }
                                }
                            ],
                            &#34;useRemoteAddress&#34;: false,
                            &#34;generateRequestId&#34;: true,
                            &#34;forwardClientCertDetails&#34;: &#34;APPEND_FORWARD&#34;,
                            &#34;setCurrentClientCertDetails&#34;: {
                                &#34;subject&#34;: true,
                                &#34;dns&#34;: true,
                                &#34;uri&#34;: true
                            },
                            &#34;upgradeConfigs&#34;: &amp;#91;
                                {
                                    &#34;upgradeType&#34;: &#34;websocket&#34;
                                }
                            ],
                            &#34;normalizePath&#34;: true
                        }
                    }
                ],
                &#34;name&#34;: &#34;10.244.2.155_9080&#34;
            }
        ],
        &#34;listenerFilters&#34;: &amp;#91;
            {
                &#34;name&#34;: &#34;envoy.listener.original_dst&#34;,
                &#34;typedConfig&#34;: {
                    &#34;@type&#34;: &#34;type.googleapis.com/envoy.config.filter.listener.original_dst.v2.OriginalDst&#34;
                }
            },
            {
                &#34;name&#34;: &#34;envoy.listener.tls_inspector&#34;,
                &#34;typedConfig&#34;: {
                    &#34;@type&#34;: &#34;type.googleapis.com/envoy.config.filter.listener.tls_inspector.v2.TlsInspector&#34;
                }
            },
            {
                &#34;name&#34;: &#34;envoy.listener.http_inspector&#34;,
                &#34;typedConfig&#34;: {
                    &#34;@type&#34;: &#34;type.googleapis.com/envoy.config.filter.listener.http_inspector.v2.HttpInspector&#34;
                }
            }
        ],
        &#34;listenerFiltersTimeout&#34;: &#34;1s&#34;,
        &#34;continueOnListenerFiltersTimeout&#34;: true,
        &#34;trafficDirection&#34;: &#34;INBOUND&#34;
    }
]
</code></pre></div><p>Check more istio practice detail at my tech blog <a href="https://imesh.club">https://imesh.club</a></p>

</div>
</div>

        </div>
      </div>
    </div>
    
  </div>

  <div class="sub-footer">
  <div class="container">
    <div class="row">
      <div class="col-12">
        <div class="sub-footer-inner">
          <ul>
            <li class="zerostatic"><a href="https://www.zerostatic.io">www.zerostatic.io</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

  

  
  

  
  <script type="text/javascript" src="/js/scripts.min.eaf147370baecdd07c022597db631f99cab1c9cd6479de586f30327a568d6a0f.js"></script>
  

  
  
  
    
  


</body>

</html>
